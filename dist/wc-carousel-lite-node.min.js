export class Customcarousel extends HTMLElement{constructor(){super(),this.item="item",this.initItem=0,this.transitionDuration=0,this.transitionType="ease",this.interval=1e3,this.direction="left",this.touchVelocityLimit=1.5,this.mouseVelocityLimit=3,this.t=30,this.i=null,this.s=null,this.h=[]}static get observedAttributes(){return["infinite","init-item","center-between","autoplay","interval","direction","transition-duration","transition-type","item","no-touch"]}disconnectedCallback(){for(;this.l.firstChild;)this.l.firstChild.remove();for(let t=0;t<this.o.length;t++)this.appendChild(this.o[t].cloneNode(!0));this.o=[],this.u=null,this.stop(this.autoplay),this.connected=!1}attributeChangedCallback(t,i,s){"infinite"===t?this.infinite=!0:"init-item"===t?this.initItem=parseInt(s):"center-between"===t?this.centerBetween=!0:"transition-duration"===t?this.transitionDuration=parseInt(s):"transition-type"===t?this.transitionType=s:"autoplay"===t?this.autoplay=!0:"interval"===t?this.interval=parseInt(s):"direction"===t?this.direction=s:"item"===t?this.item=s:"no-touch"===t&&(this.m=!0)}connectedCallback(){setTimeout(()=>{this.p()},0),this.connected=!0}next(t=1){if(0===t&&(t=1),!this.infinite)return(!this.centerBetween&&this.g+(t-1)<this.I-1||this.centerBetween&&this.g<this.I-3)&&this.v(),t=this._("l",t),void this.C(this.g+t);parseInt(getComputedStyle(this.l).left)<0&&(this.v(),this.F(t),this.C(this.g+t),this.M(t))}prev(t=1){if(0===t&&(t=1),!this.infinite)return this.g<0&&this.v(),t=this._("r",t),void this.C(this.g-t);this.l.offsetWidth+parseInt(getComputedStyle(this.l).left)>this.offsetWidth&&(this.v(),this.S(t),this.C(this.g-t),this.M(-t))}v(){this.l.style.left=getComputedStyle(this.l).left}C(t){let i=this.offsetWidth/2,s=this.l.querySelectorAll("."+this.item);if(this.centerBetween&&t===s.length-1||!s[t])return;let h,e,r,l,n=0;for(h=0;h<t;h++)r=getComputedStyle(s[h]),l=parseFloat(r.marginLeft)+parseFloat(r.marginRight),n+=s[h].offsetWidth+l;e=parseFloat(getComputedStyle(s[h]).marginRight);let a=i-(n+parseFloat(getComputedStyle(s[0]).marginLeft)+(this.centerBetween?s[t].offsetWidth+e:s[t].offsetWidth/2));this.l.style.transition="left "+this.transitionDuration+"ms",this.l.style.transitionTimingFunction=this.transitionType,this.l.style.left=a+"px",this.g=t}goto(t){if(t>this.o.length-1)return;if(!this.infinite)return void this.C(t);let i,s;i=t-this.k,s=t>this.k?t-this.k-this.o.length:t-this.k+this.o.length;let h=Math.abs(i)<=Math.abs(s)?i:s;h<0?this.S(Math.abs(h)):h>0&&this.F(Math.abs(h)),this.C(this.g+h),this.M(h)}H(t){this.l.style.left=parseInt(this.l.style.left)+t+"px"}L(t){for(;this.l.firstChild;)this.l.firstChild.remove();let i=this.querySelectorAll("."+this.item);if(i.length>0){for(let t=0;t<i.length;t++)this.l.appendChild(i[t]);t--}for(let i=0;i<t;i++)for(let t=0;t<this.o.length;t++)this.l.appendChild(this.o[t].cloneNode(!0));this.I=this.l.querySelectorAll("."+this.item).length}T(t){let i,s;return i=getComputedStyle(t),s=parseFloat(i.marginLeft)+parseFloat(i.marginRight),t.offsetWidth+s}F(t=1){for(let i=0;i<t;i++){this.l.style.transition="";let t=this.l.querySelectorAll("."+this.item)[0];this.H(this.T(t)),this.l.appendChild(this.l.removeChild(t)),this.g--}}S(t=1){for(let i=0;i<t;i++){this.l.style.transition="";let t=[...this.l.querySelectorAll("."+this.item)].pop();this.H(-this.T(t)),this.l.insertAdjacentElement("afterbegin",this.l.removeChild(t)),this.g++}}A(){if(!this.connected)return;if(!this.infinite)return void this.C(this.g);let t=parseInt(2.75*this.offsetWidth/this.R);if(this.o.length<3&&(t+=3),0===t&&t++,t%2&&t++,t!==this.u){let i;this.L(t),i=this.g?this.k:this.initItem,this.C(this.o.length*(t/2)+i),this.D(),this.u=t,this.k=i}else this.goto(this.k)}D(){let t=this.I/2-this.g;0!==t&&(t<0?this.F():t>0&&this.S(),this.D())}M(t){for(let i=0;i<Math.abs(t);i++)t>0&&(this.k+1===this.o.length?this.k=0:this.k++),t<0&&(0===this.k?this.k=this.o.length-1:this.k--)}B(){this.infinite||(this.centerBetween&&this.g>=this.I-2||this.g>=this.I-1?this.direction="right":0===this.g&&(this.direction="left")),"right"===this.direction?this.prev():this.next()}stop(t=!1){clearInterval(this.i),this.i=null,this.autoplay=t}play(){null===this.i&&(this.B(),this.i=setInterval(()=>{this.B()},this.interval),this.autoplay=!0)}_(t,i){let s;return s="l"===t?this.o.length-(this.centerBetween?2:1)-this.g:this.g,s<i?s:i}N(t){if(!t)return null;let i=0;for(;null!==(t=t.previousSibling);)i++;return i}O(t){let i=t.target.closest("."+this.item);this.W=this.N(i),t.preventDefault(),t.pageX?(this.x=t.pageX,this.y=t.pageY):t.targetTouches[0].pageX&&(this.x=t.targetTouches[0].pageX,this.y=t.targetTouches[0].pageY),this.startTime=(new Date).getTime()}j(t){let i;i=t.changedTouches?document.elementFromPoint(t.changedTouches[0].clientX,t.changedTouches[0].clientY):t.target;let s,h=i.closest("."+this.item),e=this.N(h);s=Number.isInteger(this.W)&&Number.isInteger(e)?Math.abs(this.W-e):1;let r=(t.pageX?t.pageX:t.changedTouches[0].pageX)-this.x,l=(t.pageY?t.pageY:t.changedTouches[0].pageY)-this.y,n=(new Date).getTime()-this.startTime,a=Math.abs(r/n);(a>this.touchVelocityLimit&&t.changedTouches||a>this.mouseVelocityLimit)&&s++,Math.abs(r)>this.t&&Math.abs(r)>Math.abs(l)&&(t.preventDefault(),this.q=!0,r<-this.t?this.next(s):r>this.t&&this.prev(s))}G(t){this.q&&t.preventDefault(),this.q=!1,this.focus()}J(t){"ArrowRight"===t.key?this.prev():"ArrowLeft"===t.key&&this.next()}K(){if(this.h.every(t=>!0===t.complete))return clearInterval(this.s),this.P(),!0}P(){let t,i;this.R=0;for(let s=0;s<this.o.length;s++)t=getComputedStyle(this.o[s]),i=parseFloat(t.marginLeft)+parseFloat(t.marginRight),this.R+=this.o[s].offsetWidth+i;this.infinite?this.A():(this.L(1),this.C(this.initItem)),this.autoplay&&this.play()}p(){if(this.U||(this.V=this.appendChild(document.createElement("div")),this.V.style.display="flex",this.V.style.overflow="hidden",this.l=this.V.appendChild(document.createElement("div")),this.l.style.display="flex",this.l.style.position="relative"),this.h=Array.from(this.querySelectorAll("img")),this.o=this.querySelectorAll("."+this.item),0===this.o.length)throw"couldn't find any children with "+this.item+" class";this.initItem+1>this.o.length&&(this.initItem=0);let t,i=!0;for(let s=0;s<this.o.length;s++)if(t=getComputedStyle(this.o[s]),0===parseFloat(t.width)){i=!1;break}i?this.P():this.K()||(this.s=setInterval(()=>{this.K()},100)),this.U||(this.tabIndex=0,this.m||(this.ontouchstart=this.O,this.ontouchstart=this.ontouchstart.bind(this),this.ontouchend=this.j,this.ontouchend=this.ontouchend.bind(this)),this.onmousedown=this.O,this.onmousedown=this.onmousedown.bind(this),this.onmouseup=this.j,this.onmouseup=this.onmouseup.bind(this),this.onclick=this.G,this.onclick=this.onclick.bind(this),this.onkeydown=this.J,this.onkeydown=this.onkeydown.bind(this),window.addEventListener("resize",()=>this.A())),this.U=!0}}customElements.define("wc-carousel-lite",Customcarousel);